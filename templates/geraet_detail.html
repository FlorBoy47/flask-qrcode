<!doctype html>
<html>
<head>
  <script>
    function toggleProblemfeld() {
      const checkbox = document.getElementById("probleme");
      const beschreibung = document.getElementById("problem_beschreibung_feld");
      beschreibung.style.display = checkbox.checked ? "block" : "none";
    }
  </script>
</head>
<body>
<h2>{{ geraet.name }}</h2>
<p>{{ geraet.beschreibung }}</p>

{% if user == "Admin" %}
<h3>Benutzereinträge:</h3>
<p><strong>Kunde:</strong> {{ notiz.kunde if notiz else "-" }}</p>
<p><strong>Problem gemeldet:</strong> {% if notiz and notiz.probleme %}Ja{% else %}Nein{% endif %}</p>
{% if notiz and notiz.probleme %}
<p><strong>Problembeschreibung:</strong> {{ notiz.problembeschreibung }}</p>
{% endif %}
<p><strong>Sonstige Informationen:</strong> {{ notiz.info_user if notiz else "-" }}</p>

<hr>
<h3>Admin-Felder bearbeiten:</h3>
<form method="POST">
  <input type="hidden" name="admin_speichern" value="1">
  Geliefert am: <input type="text" name="geliefert_am" value="{{ admin_notiz.geliefert_am if admin_notiz else '' }}"><br>
  Infos zu Problemen: <br><textarea name="info_problem_admin">{{ admin_notiz.info_problem_admin if admin_notiz else '' }}</textarea><br>
  Sonstige Informationen: <br><textarea name="info_admin">{{ admin_notiz.info_admin if admin_notiz else '' }}</textarea><br>
  <button type="submit">Speichern</button>
</form>

{% else %}
<form method="POST">
  <input type="hidden" name="user_speichern" value="1">
  Kunde: <input type="text" name="kunde" value="{{ notiz.kunde if notiz else '' }}"><br>

  <input type="checkbox" id="probleme" name="probleme" value="1" {% if notiz and notiz.probleme %}checked{% endif %} onclick="toggleProblemfeld()">
  <label for="probleme">Problem vorhanden</label><br>

  <div id="problem_beschreibung_feld" style="display: {% if notiz and notiz.probleme %}block{% else %}none{% endif %};">
    Problembeschreibung:<br>
    <textarea name="problembeschreibung">{{ notiz.problembeschreibung if notiz else '' }}</textarea><br>
  </div>

  Sonstige Informationen:<br>
  <textarea name="info_user">{{ notiz.info_user if notiz else '' }}</textarea><br>

  <button type="submit">Speichern</button>
</form>
{% endif %}

<br><a href="{{ url_for('geraete_liste') }}">Zurück zur Übersicht</a>
</body>
</html>
